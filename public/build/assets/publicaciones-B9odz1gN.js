import{i as d,D as H,r as J,o as p,c as m,a as t,w as s,d as e,F as E,E as b,b as i,G as K,t as _,f as U,u as Q}from"./app-Q_3-Ao_u.js";/* empty css                                                                         */import{C as W}from"./index-OQ_TK0Vr.js";import{M as X}from"./index-Cb0qmqF9.js";import{a as k}from"./index-DuTkR8vF.js";import{B as Z}from"./index-6QXb-wCm.js";import{I as ee}from"./index-DMc2qG6d.js";import{D as oe}from"./dayjs-Cf3fWCgS.js";import{S as te}from"./index-C2ZM5AhM.js";import{_ as se,F as ae}from"./index-bhdxRi8w.js";import{f as le}from"./format-cwXK75ha.js";import{_ as re,a as ne}from"./index-DwHKXQPf.js";import{_ as ie}from"./index-D89vegDn.js";import"./compact-item-Z78VztqK.js";import"./index-BamLtfVa.js";import"./Col-CPKWV_BO.js";import"./firstNotUndefined-wHvDY7Z8.js";import"./shallowequal-BKZtUhw6.js";import"./index-8_AQkQAU.js";import"./injectionKey-BXVc-oGP.js";import"./collapseMotion-DVas_xK4.js";import"./useRefs-B1plTYKw.js";import"./FormItemContext-DvseOeOv.js";import"./statusUtils-CPur5UmF.js";import"./index-CYyBPbGM.js";import"./EyeOutlined-fYOyLmCa.js";import"./dayjs.min-9JZSo2wI.js";import"./useMemo-D9xz1Y-O.js";import"./move-g5z7UrKN.js";import"./DownOutlined-D0euq62q.js";import"./CheckOutlined-DhNylv5v.js";const de={class:"flex justify-between border-b-2",style:{"border-bottom":"solid 2px #009DD1","padding-bottom":"8px"}},ce=e("div",null,[e("span",{style:{"font-weight":"bold","font-size":"1rem",color:"#009DD1"}}," III. Investigaciones y publicaciones")],-1),ue={style:{"margin-top":"-5px"}},pe={class:"mt-3"},me={class:"flex justify-between",style:{}},_e={class:""},fe={class:"font-bold"},ve={style:{"font-size":"0.9rem"}},ge={class:"italic",style:{"margin-bottom":"-5px","margin-top":"-2px"}},he={style:{"font-size":".8rem"}},ye={class:"flex",style:{"margin-top":"0px"}},be=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-eye"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1),we=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1a2843","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit-2"},[e("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})],-1),xe=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trash"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1),ke=e("label",null,[i("Título"),e("span",{style:{color:"red"}},"*")],-1),De=e("label",null,[i("Fec. publicacion"),e("span",{style:{color:"red"}},"* "),i("(DD/MM/AAAA)")],-1),Ce=e("label",null,[i("Tipo"),e("span",{style:{color:"red"}},"*")],-1),Fe=e("label",null,[i("Archivo PDF (Max. 2mb)"),e("span",{style:{color:"red"}},"*")],-1),Me={key:0,class:"mt-2"},Le=["src"],Ae={class:"flex justify-end"},Ee={key:0,class:"mt-2"},Ue=["src"],Be={class:"flex justify-end"},po={__name:"publicaciones",setup(Pe){const B=window.location.origin,f=d(!1),D=d([]),C=d([]),v=d(!1),g=d(null),r=H({id:null,titulo:null,fec_publicacion:null,tipo:null,fileList:[]}),P=()=>{r.id=null,r.descripcion="",r.tipo=null,r.fileList=[],f.value=!0},F=o=>{g.value=o,v.value=!0},j=async()=>{try{const o=await b.get("/get-tipo-investigacion-publicaicon");o.data.estado?C.value=o.data.datos:console.error("Ocurrió un error al obtener tipos.")}catch(o){console.error("Error en la solicitud de tipos:",o)}},T=async o=>{try{(await b.get(`/eliminar-titulo/${o}`)).data.estado?await w():console.error("No se pudo eliminar el título.")}catch(a){console.error("Error al eliminar el título:",a)}},w=async()=>{try{const o=await b.get("/get-publicaciones");o.data.estado?D.value=o.data.datos:console.error("No se encontraron títulos.")}catch(o){console.error("Error en la solicitud de títulos:",o)}},z=()=>{g.value=null,r.fileList=[]},u=d(!1),h=d(null),M=d(0),I=o=>{if(o.type==="application/pdf"){const a=new FileReader;a.onload=n=>{h.value=n.target.result},a.readAsDataURL(o),r.fileList=[o]}else k.error("¡Solo puedes cargar archivos PDF!");return!1},R=async()=>{const o=new FormData;o.append("file",r.fileList[0]),o.append("fec_publicacion",le(new Date(r.fec_publicacion),"yyyy-MM-dd")),o.append("autor",r.autor),o.append("titulo",r.titulo),o.append("tipo",r.tipo);try{u.value=!0,M.value=0;const a=await b.post("subir-publicaciones",o,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer your-auth-token"},onUploadProgress:n=>{M.value=Math.round(n.loaded*100/n.total)}});f.value=!1,u.value=!1,k.success("¡Archivo PDF cargado exitosamente!"),await w()}catch(a){u.value=!1,k.error("Error al cargar el archivo."),console.error("Error en la carga del archivo:",a)}},S=o=>{var a=o.split("-"),n=a.reverse().join("/");return n};return w(),j(),(o,a)=>{const n=Z,c=re,x=ne,V=W,N=ee,y=se,$=oe,q=te,O=J("upload-outlined"),Y=ie,G=ae,L=X;return p(),m(E,null,[t(V,{class:"mx-2 my-2"},{default:s(()=>[e("div",null,[e("div",de,[ce,e("div",ue,[t(n,{onClick:a[0]||(a[0]=l=>P())},{default:s(()=>[i("Agregar")]),_:1})])]),e("div",pe,[(p(!0),m(E,null,K(D.value,l=>(p(),m("div",{class:"mb-2",key:l},[t(x,{gutter:16},{default:s(()=>[t(c,{xs:24,sm:4,md:4,lg:2},{default:s(()=>[e("div",null,_(S(l.fec_publicacion)),1)]),_:2},1024),t(c,{xs:24,sm:20,md:20,lg:22},{default:s(()=>[e("div",me,[e("div",_e,[e("div",null,[e("span",fe,_(l.descripcion),1)]),e("div",null,[e("span",ve,_(l.titulo),1)]),e("div",ge,[e("span",he,"( "+_(l.participacion)+" )",1)])]),e("div",ye,[t(n,{onClick:A=>F(l.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>[be]),_:2},1032,["onClick"]),t(n,{onClick:A=>F(l.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>[we]),_:2},1032,["onClick"]),t(n,{danger:"",onClick:A=>T(l.id),style:{width:"20px",height:"20px","padding-left":"3px"}},{default:s(()=>[xe]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024)]))),128))])])]),_:1}),e("div",null,[t(L,{open:f.value,"onUpdate:open":a[4]||(a[4]=l=>f.value=l),title:"Registro de investacion",onOk:o.handleOk},{footer:s(()=>[e("div",Ae,[t(n,{type:"primary",disabled:!h.value,loading:u.value,style:{"margin-top":"16px"},onClick:R},{default:s(()=>[i(_(u.value?"Subiendo...":"Comenzar carga"),1)]),_:1},8,["disabled","loading"])])]),default:s(()=>[t(G,{ref:"formDatos",name:"form",model:r,rules:o.formRules},{default:s(()=>[t(x,{gutter:16},{default:s(()=>[t(c,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[ke,t(y,{name:"titulo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t(N,{value:r.titulo,"onUpdate:value":a[1]||(a[1]=l=>r.titulo=l),style:{height:"32px"}},{suffix:s(()=>[]),_:1},8,["value"])]),_:1})]),_:1}),t(c,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[De,t(y,{name:"fec_publicacion",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t($,{style:{width:"100%"},placeholder:"Seleccionar fec. publicación",value:r.fec_publicacion,"onUpdate:value":a[2]||(a[2]=l=>r.fec_publicacion=l),format:"DD/MM/YYYY"},null,8,["value"])]),_:1})]),_:1}),t(c,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[Ce,t(y,{name:"tipo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t(q,{ref:"select",value:r.tipo,"onUpdate:value":a[3]||(a[3]=l=>r.tipo=l),style:{width:"100%"},options:C.value,onFocus:o.focus,onChange:o.selecionarTipo},null,8,["value","options","onFocus","onChange"])]),_:1})]),_:1}),t(c,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[Fe,t(y,{name:"fileList",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t(Y,{"file-list":r.fileList,"before-upload":I,onRemove:z},{default:s(()=>[t(n,null,{default:s(()=>[t(O),i(" Seleccionar archivo PDF ")]),_:1})]),_:1},8,["file-list"]),h.value?(p(),m("div",Me,[e("iframe",{src:h.value,width:"100%",height:"300px"},null,8,Le)])):U("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","onOk"]),t(L,{open:v.value,"onUpdate:open":a[6]||(a[6]=l=>v.value=l),title:"Registro de título",style:{"min-width":"900px"}},{footer:s(()=>[e("div",Be,[t(n,{onClick:a[5]||(a[5]=l=>v.value==!1)},{default:s(()=>[i(" Aceptar ")]),_:1})])]),default:s(()=>[t(x,{gutter:16},{default:s(()=>[t(c,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[g.value?(p(),m("div",Ee,[e("iframe",{src:Q(B)+"/"+g.value,width:"100%",height:"500px"},null,8,Ue)])):U("",!0)]),_:1})]),_:1})]),_:1},8,["open"])])],64)}}};export{po as default};
