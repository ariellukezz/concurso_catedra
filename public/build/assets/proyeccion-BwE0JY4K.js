import{i,D as q,r as I,o as p,c as m,a as o,w as t,E as g,F as G,G as H,d as a,t as b,b as u,f as E,u as J}from"./app-DjzP6Xc8.js";import{M as K}from"./index-D4hYEUdR.js";import{a as k}from"./index-C6cJBKTJ.js";import{B as Q}from"./index-B-NKoIPa.js";import{C as W}from"./index-D0HqagQ7.js";import{I as X}from"./index-DX_P1xWU.js";import{S as Y}from"./index-CllVJQ-s.js";import{_ as Z,F as ee}from"./index-BVPH4-rA.js";import{a as oe,_ as te}from"./index-DVqLySPe.js";import{f as ae}from"./format-cwXK75ha.js";import{_ as se}from"./index-Dz-7ay72.js";import"./compact-item-C3MMsdSX.js";import"./FormItemContext-BStwt122.js";import"./Col-D9pf7s4-.js";import"./firstNotUndefined-By4c3kmV.js";import"./index-CZlnR-fw.js";import"./index-C9tvn3ls.js";import"./shallowequal-Bw13IqAx.js";import"./injectionKey-BXVc-oGP.js";import"./collapseMotion-v82YJKL-.js";import"./useRefs-CY2EYO9G.js";import"./statusUtils-DDrkrFt_.js";import"./index-D7UOKjLm.js";import"./EyeOutlined-C0haTXOK.js";import"./useMemo-BDnbGG_P.js";import"./DownOutlined-BjpBAteB.js";import"./CheckOutlined-C91lsFFN.js";import"./move-DKmVe9rK.js";const le={class:"p-4"},re={class:"flex justify-between",style:{margin:"-15px -10px"}},ne={class:""},ie={class:"font-bold",style:{"font-size":"1rem"}},de={class:"flex",style:{"margin-top":"0px"}},ue=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1a2843","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit-2"},[a("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})],-1),ce=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trash"},[a("polyline",{points:"3 6 5 6 21 6"}),a("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1),pe=a("label",null,[u("Actividad"),a("span",{style:{color:"red"}},"*")],-1),me=a("label",null,[u("Tipo"),a("span",{style:{color:"red"}},"*")],-1),_e=a("label",null,[u("Archivo PDF (Max. 2mb)"),a("span",{style:{color:"red"}},"*")],-1),fe={key:0,class:"mt-2"},ve=["src"],ge={class:"flex justify-end"},he={key:0,class:"mt-2"},ye=["src"],we={class:"flex justify-end"},We={__name:"proyeccion",setup(xe){const U=window.location.origin,h=i(!1),C=i([]),D=i([]),_=i(!1),f=i(null),r=q({id:null,actividad:null,tipo:null,fileList:[]}),B=e=>{f.value=e,_.value=!0},M=async()=>{try{const e=await g.get("/get-tipo-investigacion-publicaicon");e.data.estado?D.value=e.data.datos:console.error("Ocurrió un error al obtener tipos.")}catch(e){console.error("Error en la solicitud de tipos:",e)}},P=async e=>{try{(await g.get(`/eliminar-titulo/${e}`)).data.estado?await y():console.error("No se pudo eliminar el título.")}catch(s){console.error("Error al eliminar el título:",s)}},y=async()=>{try{const e=await g.get("/get-publicaciones");e.data.estado?C.value=e.data.datos:console.error("No se encontraron títulos.")}catch(e){console.error("Error en la solicitud de títulos:",e)}},R=()=>{f.value=null,r.fileList=[]},c=i(!1),v=i(null),F=i(0),T=e=>{if(e.type==="application/pdf"){const s=new FileReader;s.onload=n=>{v.value=n.target.result},s.readAsDataURL(e),r.fileList=[e]}else k.error("¡Solo puedes cargar archivos PDF!");return!1},A=async()=>{const e=new FormData;e.append("file",r.fileList[0]),e.append("fec_publicacion",ae(new Date(r.fec_publicacion),"yyyy-MM-dd")),e.append("autor",r.autor),e.append("titulo",r.titulo),e.append("tipo",r.tipo);try{c.value=!0,F.value=0;const s=await g.post("subir-publicaciones",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer your-auth-token"},onUploadProgress:n=>{F.value=Math.round(n.loaded*100/n.total)}});h.value=!1,c.value=!1,k.success("¡Archivo PDF cargado exitosamente!"),await y()}catch(s){c.value=!1,k.error("Error al cargar el archivo."),console.error("Error en la carga del archivo:",s)}};return y(),M(),(e,s)=>{const n=Q,N=W,d=te,w=oe,S=X,x=Z,V=Y,j=I("upload-outlined"),z=se,O=ee,L=K;return p(),m("div",le,[o(w,{gutter:16},{default:t(()=>[o(d,{xs:24,sm:12,md:8,lg:12},{default:t(()=>[(p(!0),m(G,null,H(C.value,l=>(p(),m("div",{class:"mb-2",key:l},[o(N,{class:"p-0"},{default:t(()=>[a("div",re,[a("div",ne,[a("div",null,[a("span",ie,b(l.titulo),1)]),a("div",null,b(l.autor),1)]),a("div",de,[o(n,{onClick:$=>B(l.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:t(()=>[ue]),_:2},1032,["onClick"]),o(n,{danger:"",onClick:$=>P(l.id),style:{width:"20px",height:"20px","padding-left":"3px"}},{default:t(()=>[ce]),_:2},1032,["onClick"])])])]),_:2},1024)]))),128))]),_:1}),o(d,{xs:24,sm:12,md:8,lg:12})]),_:1}),o(L,{open:h.value,"onUpdate:open":s[2]||(s[2]=l=>h.value=l),title:"Registro de actividades",onOk:e.handleOk},{footer:t(()=>[a("div",ge,[o(n,{type:"primary",disabled:!v.value,loading:c.value,style:{"margin-top":"16px"},onClick:A},{default:t(()=>[u(b(c.value?"Subiendo...":"Comenzar carga"),1)]),_:1},8,["disabled","loading"])])]),default:t(()=>[o(O,{ref:"formDatos",name:"form",model:r,rules:e.formRules},{default:t(()=>[o(w,{gutter:16},{default:t(()=>[o(d,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[pe,o(x,{name:"actividad",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:t(()=>[o(S,{value:r.actividad,"onUpdate:value":s[0]||(s[0]=l=>r.actividad=l),style:{height:"32px"}},{suffix:t(()=>[]),_:1},8,["value"])]),_:1})]),_:1}),o(d,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[me,o(x,{name:"tipo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:t(()=>[o(V,{ref:"select",value:r.tipo,"onUpdate:value":s[1]||(s[1]=l=>r.tipo=l),style:{width:"100%"},options:D.value,onFocus:e.focus,onChange:e.selecionarTipo},null,8,["value","options","onFocus","onChange"])]),_:1})]),_:1}),o(d,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[_e,o(x,{name:"fileList",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:t(()=>[o(z,{"file-list":r.fileList,"before-upload":T,onRemove:R},{default:t(()=>[o(n,null,{default:t(()=>[o(j),u(" Seleccionar archivo PDF ")]),_:1})]),_:1},8,["file-list"]),v.value?(p(),m("div",fe,[a("iframe",{src:v.value,width:"100%",height:"300px"},null,8,ve)])):E("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","onOk"]),o(L,{open:_.value,"onUpdate:open":s[4]||(s[4]=l=>_.value=l),title:"Registro de título",style:{"min-width":"900px"}},{footer:t(()=>[a("div",we,[o(n,{onClick:s[3]||(s[3]=l=>_.value==!1)},{default:t(()=>[u(" Aceptar ")]),_:1})])]),default:t(()=>[o(w,{gutter:16},{default:t(()=>[o(d,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[f.value?(p(),m("div",he,[a("iframe",{src:J(U)+"/"+f.value,width:"100%",height:"500px"},null,8,ye)])):E("",!0)]),_:1})]),_:1})]),_:1},8,["open"])])}}};export{We as default};
